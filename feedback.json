import json
import os

FEEDBACK_FILE = 'feedback_data.json'

def save_feedback(data):
    feedback = {
        'name': data.get('name', 'Anonymous'),
        'message': data.get('message', '')
    }

    all_feedback = []
    if os.path.exists(FEEDBACK_FILE):
        try:
            with open(FEEDBACK_FILE, 'r', encoding='utf-8') as f:
                all_feedback = json.load(f)
        except json.JSONDecodeError:
            all_feedback = []  # Reset file if it is corrupted

    all_feedback.append(feedback)

    with open(FEEDBACK_FILE, 'w', encoding='utf-8') as f:
        json.dump(all_feedback, f, indent=4)

def get_all_feedback():
    if os.path.exists(FEEDBACK_FILE):
        try:
            with open(FEEDBACK_FILE, 'r', encoding='utf-8') as f:
                return json.load(f)
        except json.JSONDecodeError:
            return []
    return []


